{% load static %}

<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Explore Page</title>
    <link rel="stylesheet" href="{% static 'css/index.css' %}">
    <link rel="stylesheet" href="{% static 'css/styles.css' %}">
</head>
<body>
    <header>
        <nav>
            <ul>
                <li><a href="{% url 'index' %}">Home</a></li>
                <li><a href="{% url 'explore' %}">Explore</a></li>
                <li><a href="{% url 'about' %}">About</a></li>
                <li><a href="{% url 'profile' %}">Profile</a></li>
                <li><a href="{% url 'login' %}">Login</a></li>
            </ul>
        </nav>
        <h1>Explore Page</h1>
    </header>
    <main>
        <h2>Welcome to the Explore Page!</h2>
        <form id="search-form">
            <input type="text" id="city-name" placeholder="Enter a city name">
            <button type="submit">Search</button>
        </form>
        <div id="youtube-videos">
            <div id="london-video" class="city-video"></div>
            <div id="paris-video" class="city-video"></div>
            <div id="edinburgh-video" class="city-video"></div>
        </div>
    </main>
    <script>
        function loadCityVideo(cityName, containerId) {
            fetch('/tripapp/search_youtube/?city=' + encodeURIComponent(cityName + ' travel'))
                .then(response => response.json())
                .then(data => {
                    const container = document.getElementById(containerId);
                    container.innerHTML = ''; // Clear previous results

                    if (data && data.length > 0) {
                        const video = data[0]; // Get the first video
                        const videoFrame = document.createElement('iframe');
                        videoFrame.width = "100%";
                        videoFrame.height = "300";
                        videoFrame.src = `https://www.youtube.com/embed/${video.id.videoId}`;
                        videoFrame.frameBorder = "0";
                        videoFrame.allowFullscreen = true;
                        videoFrame.classList.add('video-iframe');

                        const videoTitle = document.createElement('h3');
                        videoTitle.textContent = video.snippet.title;
                        videoTitle.classList.add('video-title');

                        const videoDescription = document.createElement('p');
                        videoDescription.textContent = video.snippet.description;
                        videoDescription.classList.add('video-description');

                        const videoInfo = document.createElement('div');
                        videoInfo.classList.add('video-info');

                        videoInfo.appendChild(videoTitle);
                        videoInfo.appendChild(videoDescription);

                        const videoContainer = document.createElement('div');
                        videoContainer.classList.add('video-container');

                        videoContainer.appendChild(videoFrame);
                        videoContainer.appendChild(videoInfo);

                        container.appendChild(videoContainer);
                    } else {
                        // Handle case where no videos are returned
                        container.textContent = 'No videos found for ' + cityName;
                    }
                })
                .catch(error => {
                    console.error('Error fetching data for ' + cityName + ':', error);
                });
        }

        document.getElementById('search-form').addEventListener('submit', function(e) {
            e.preventDefault();
            var cityName = document.getElementById('city-name').value + ' travel';
            loadCityVideo(cityName, 'youtube-videos');
        });

        window.onload = function() {
            loadCityVideo('London', 'london-video');
            loadCityVideo('Paris', 'paris-video');
            loadCityVideo('Edinburgh', 'edinburgh-video');
        };
    </script>
</body>
</html>
